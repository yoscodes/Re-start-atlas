-- ============================================
-- 「最初に誤解していたこと」フィールドの追加
-- 目的: 個人の内側のズレを1つだけ可視化する
-- ============================================

-- ============================================
-- 1. initial_misconception カラムの追加
-- ============================================
ALTER TABLE public.recovery_posts 
ADD COLUMN IF NOT EXISTS initial_misconception TEXT;

-- ============================================
-- 2. コメントの追加
-- ============================================
COMMENT ON COLUMN public.recovery_posts.initial_misconception IS '最初に誤解していたこと（1投稿につき最大1つ）。当時の認識のズレを共有する。教訓・HowToではなく、後出しの正解を言わない。投稿者が後から追記可能。';

-- ============================================
-- 3. RPC関数の更新: create_recovery_post
-- ============================================
-- 注意: 既存のcreate_recovery_post関数を確認して、initial_misconceptionパラメータを追加する必要がある
-- このマイグレーションではカラム追加のみ行い、RPC関数の更新は別ファイルで行う
